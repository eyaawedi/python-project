import pandas as pd
import plotly.graph_objs as go

# Load data from the "Supplier_Performance" sheet of the Excel file
supplier_performance_df = pd.read_excel('cleaned_data0.xlsx', sheet_name='Supplier_Performance')

# Create a scatter plot for Total Revenue vs. Profitability
scatter_fig_total_revenue_vs_profitability = go.Figure()

# Add trace for scatter plot
scatter_fig_total_revenue_vs_profitability.add_trace(go.Scatter(
    x=supplier_performance_df['total_revenue'],
    y=supplier_performance_df['profitability'],
    mode='markers',
    marker=dict(
        color='rgba(0, 128, 0, 0.6)',
        size=10
    ),
    text=supplier_performance_df['supplier_code'],
    hoverinfo='text+y+x'
))

# Customizing layout
scatter_fig_total_revenue_vs_profitability.update_layout(
    title='Total Revenue vs Profitability (Supplier_Performance)',
    xaxis_title='Total Revenue',
    yaxis_title='Profitability',
    plot_bgcolor='rgba(0,0,0,0)',
    paper_bgcolor='rgba(0,0,0,0)',
    font=dict(color='black')
)

# Show the scatter plot
scatter_fig_total_revenue_vs_profitability.show()
